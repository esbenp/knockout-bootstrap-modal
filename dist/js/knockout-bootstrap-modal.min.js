!function(t,e){"function"==typeof define&&define.amd?define(["jquery","knockout","bootstrap","text!knockout-bootstrap-modal-html","require","knockout-undomanager"],e):"object"==typeof exports?module.exports=e(require("jquery"),require("knockout"),require("bootstrap"),require("text!knockout-bootstrap-modal-html"),require("require"),require("knockout-undomanager")):t.KnockoutBootstrapModal=e(t.jQuery,t.ko,t.jQuery,t.KnockoutBootstrapModalHtml,t.jQuery,t.knockoutUndoManager)}(this,function(t,e,o,n,r,i){if("undefined"==typeof a)var a={};!function(e){"use strict";var o=function(t,o){this.instance=t,this.initialize(o);new e.Template(this.instance)};o.prototype.createContainerFromHtml=function(e){var o=t(e),n=t(this.instance.settings.appendContainerTo);if(0===n.length)throw Error("Knockout-bootstrap-modal: Could not find an element with selector '"+this.instance.settings.appendContainerTo+"' to append the modal container to.");return o.appendTo(n),o},o.prototype.evaluateContainerInput=function(t){return s(t)},o.prototype.initialize=function(t){if("undefined"!=typeof t)return this.setContainer(t);if("undefined"!=typeof n)return this.setContainer(this.createContainerFromHtml(n));throw Error("Knockout-bootstrap-modal: No valid container was given.")},o.prototype.setContainer=function(t){var t=this.evaluateContainerInput(t);if(0===t.length)throw Error("Knockout-bootstrap-modal: Could not find container with selector "+t);return this.instance.container=t,t},e.Factory=o}(a,n),function(o){"use strict";var n=function(i,s){this.container,this.settings=t.extend(n.DEFAULTS,s||{}),this.variables={callbacks:{},closeClick:r.bind(this),saveClick:a.bind(this),template:e.observable(""),templateIsExternal:!1,templateVariables:{closeButton:e.observable(!0),closeCross:e.observable(!0),footer:e.observable(!0),header:e.observable(!0),saveButton:e.observable(!0),title:e.observable(!1)},viewmodel:{}};new o.Factory(this,i)};n.DEFAULTS={appendContainerTo:"body",body:".modal-body"};var r=function(){return this.undoRedoStack.undoCommand.execute(),l(this.variables.callbacks.close),this.hide(),!0},a=function(){return this.hide(),l(this.variables.callbacks.save),!0};n.prototype.close=function(t){return this.variables.callbacks.close=t,this},n.prototype.closeButton=function(t){return this.variables.templateVariables.closeButton(t),this},n.prototype.closeCross=function(t){return this.variables.templateVariables.closeCross(t),this},n.prototype.hide=function(){return this.container.modal("hide"),this},n.prototype.show=function(){return e.applyBindings(this.variables,this.container[0]),this.container.modal("show"),this},n.prototype.save=function(t){return this.variables.callbacks.save=t,this},n.prototype.saveButton=function(t){return this.variables.templateVariables.saveButton(t),this},n.prototype.title=function(t){return this.variables.templateVariables.title(t),this},n.prototype.template=function(t,e){return"undefined"!=typeof e&&(this.variables.templateIsExternal=e),this.variables.template(t),this},n.prototype.viewmodel=function(t){return this.variables.viewmodel=t,this.undoRedoStack=i(this.variables.viewmodel),this},o.Modal=function(){return new n}}(a),function(e,o){"use strict";var n=function(t){this.instance=t,this.setupTemplateListener(this.instance)};n.prototype.insertTemplate=function(e){var o=s(this.instance.settings.body),e=t(e);o.html(""),e.appendTo(o)},n.prototype.loadExternalUsingjQuery=function(e,o){var n=t.ajax({url:e});t.when(n).then(function(t){o.resolve(t)})},n.prototype.loadExternalUsingRequire=function(t,e){o(["text!"+t],function(t){e.resolve(t)})},n.prototype.setupTemplateContentPromise=function(){var e=this,o=t.Deferred();return t.when(o).then(function(t){e.insertTemplate(t)}),o},n.prototype.setupTemplateListener=function(t){var e=this;t.variables.template.subscribe(function(n){var r=t.variables.templateIsExternal,i=e.setupTemplateContentPromise();r?o instanceof jQuery?e.loadExternalUsingjQuery(n,i):e.loadExternalUsingRequire(n,i):i.resolve(n)})},e.Template=n}(a,r);var s=function(e,o){if(e.nodeType)return t(e);if(e instanceof jQuery)return e;var n=t(e);if(0===n.length&&o!==!1)throw Error("Knockout-bootstrap-modal: Could not find element with selector '"+e+"'");return n},l=function(){var t=arguments[0],e=Array.prototype.slice.call(arguments);return e.shift(),"function"==typeof t?t.apply(this,e):!1};return a.Modal});